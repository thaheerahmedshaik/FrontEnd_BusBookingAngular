<div class="bus-container">
  <h2>Available Buses</h2>

  <!-- No buses -->
  <div *ngIf="buses.length === 0" class="no-buses">
    No buses found for your search.
  </div>

  <!-- Bus list -->
  <div *ngFor="let bus of buses; trackBy: trackByBusId" class="bus-card">
    <h3>{{ bus.busName }}</h3>
    <p>{{ bus.fromCity }} â†’ {{ bus.toCity }}</p>
    <p>ðŸ•‘ {{ bus.departureTime }} - {{ bus.arrivalTime }} ({{ bus.duration }})</p>
    <p>ðŸ’° Price: â‚¹{{ bus.price }}</p>
    <button (click)="openSeatSelection(bus)">Select Seats</button>
  </div>

  <!-- Seat selection -->
  <div *ngIf="showSeatSelection && selectedBus" class="seat-section">
    <h3>Choose Seats for {{ selectedBus.busName }}</h3>

    <!-- Seat grid -->
    <div class="seats">
      <div *ngFor="let seat of seats; trackBy: trackBySeatId"
           (click)="toggleSeat(seat)"
           [class.selected]="selectedSeats.includes(seat)"
           [class.unavailable]="!seat.available">
        {{ seat.number }}
      </div>
    </div>

    <!-- Passenger form -->
    <div class="passenger-form" *ngIf="selectedSeats.length > 0">
      <h4>Passenger Details</h4>
      <form [formGroup]="passengerForm">
        <div formArrayName="passengers" *ngFor="let p of passengers.controls; let i = index">
          <div [formGroupName]="i" class="passenger-card">
            <p>Seat: {{ selectedSeats[i]?.number }}</p>
            <input formControlName="name" placeholder="Name" />
            <input formControlName="age" type="number" placeholder="Age" />
            <input formControlName="phone" placeholder="Phone" />
            <input formControlName="state" placeholder="State" />
          </div>
        </div>
      </form>
      <button class="btn-confirm" (click)="confirmBooking()">Confirm Booking</button>
    </div>
  </div>
</div>
